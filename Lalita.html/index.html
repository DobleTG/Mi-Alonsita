<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mi Alonsita ‚ù§Ô∏è</title>

<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,500;1,500&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;500;600&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Parisienne&display=swap" rel="stylesheet">

<style>
body{
  margin:0;
  min-height:100vh;
  font-family:'Segoe UI',system-ui,sans-serif;
  background:#0d0d0d;
  display:flex;
  justify-content:center;
  align-items:flex-start; 
  overflow-x:hidden;
  padding:16px;
}

/* FONDO */
.fondo{
  position:fixed;
  inset:0;
  background:
    radial-gradient(circle, rgba(0,0,0,.35), rgba(0,0,0,.85)),
    url('recuerdo.jpg') center/110% no-repeat;
  opacity:0;
  transform:scale(1.05);
  transition:opacity 3.5s ease, transform 4.5s ease;
  z-index:-2;
}
body.abierto .fondo{
  opacity:0.45;
  transform:scale(1);
}

/* VIDEO FONDO */
.video-fondo{
  position:fixed;
  inset:0;
  object-fit:cover;
  opacity:0;
  transition:opacity 3s ease;
  z-index:-3;
  pointer-events:none;
}
.video-activo{
  opacity:0.5;
}

/* TEXTO LUMINOSO */
#nombre-luz{
  position:absolute;
  bottom:6%;
  right:6%;
  max-width:88%;
  text-align:right;

  font-family:'Great Vibes', 'Playfair Display', serif;
  font-size:clamp(1.6em, 4vw, 3em);
  letter-spacing:0.06em;

  color:#ffd88a;
  opacity:0;
  pointer-events:none;

  text-shadow:
    0 0 10px rgba(255,220150,.6),
    0 0 22px rgba(255,200,120,.9),
    0 0 38px rgba(255,170,80,1);

  transition:opacity 2.5s ease;
  z-index:6;
}




.letra-suave{
  opacity:0;
  filter:blur(4px);
  display:inline-block;
  transition:
    opacity .45s ease,
    filter .6s ease;
}

.letra-suave.visible{
  opacity:1;
  filter:blur(0);
}


/* PALPITAR */
.palpitar{
  animation:palpitar 4.5s ease-in-out infinite;
}
@keyframes palpitar{
  0%,100%{ transform:scale(1); }
  50%{ transform:scale(1.04); }
}

/* CONTENEDOR */
.wrap{
  width:100%;
  max-width:460px;  
  margin:0 auto;
  perspective:1400px;
  position:relative;
  z-index:5;
}

/* LUZ */
.luz{
  position:absolute;
  inset:-60%;
  background:radial-gradient(circle,rgba(255,220,160,.55),transparent 70%);
  opacity:0;
  pointer-events:none;
}
.abierto ~ .luz{
  opacity:1;
  animation:respirar 6s ease-in-out infinite;
}
@keyframes respirar{
  0%,100%{ opacity:.4; }
  50%{ opacity:.75; }
}

/* SOBRE */
.sobre{
  position:relative;
  width:100%;
  aspect-ratio:16/10;
  background:url('sobre.jpg') center/cover no-repeat;
  border-radius:14px;
  box-shadow:0 30px 65px rgba(0,0,0,.65);
  overflow:hidden;
  transform-style:preserve-3d;
  transform:scale(1);

}

/* TAPA */
.tapa{
  position:absolute;
  top:0;
  left:0;
  width:100%;
  height:50%;
  background:transparent;   /* üëà CLAVE */
  transform-origin:top;
  transition:transform 1.8s cubic-bezier(.2,.8,.2,1);
  z-index:6;
}
.tapa::before{
  content:"";
  position:absolute;
  inset:0;
  background:inherit;
  background-image:inherit;
  background-size:inherit;
  background-position:inherit;
  clip-path:inset(0 0 50% 0);
}

/* SELLO */
.sello{
  position:absolute;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%);
  width:78px;
  height:78px;
  background:radial-gradient(circle at 30% 30%,#c0392b,#7a1510);
  border-radius:50%;
  box-shadow:
    inset -6px -6px 10px rgba(0,0,0,.45),
    inset 3px 3px 6px rgba(255,255,255,.2),
    0 10px 25px rgba(0,0,0,.6);
  z-index:7;
  display:flex;
  align-items:center;
  justify-content:center;
  color:#ffd6c9;
  font-family:'Times New Roman',serif;
  font-size:22px;
  letter-spacing:2px;
  transition:opacity .7s ease, transform .7s ease;
}
.sello .amp{
  font-size:0.65em;
  margin:0 4px;
  opacity:0.85;
}

/* CARTA */
.carta{
  position:absolute;
  inset:10px;
  background:linear-gradient(
    rgba(253,247,236,0.85),
    rgba(253,247,236,0.95)
  );
  border-radius:10px;
  padding:28px 22px;
  transform:translateY(95%);
  opacity:0;
  transition:transform 1.6s ease, opacity 1.4s ease;
  box-shadow:0 12px 30px rgba(0,0,0,.4);
  overflow-y:auto;
}

h1{ margin:0 0 14px; font-size:1.6em; color:#5a2a3c; }
p{ margin:0; font-size:1.1em; color:#4a2b2b; line-height:1.75; white-space:pre-line; }
/* TEXTO MANUSCRITO CARTAS */
.carta p,
.carta2 p{
  font-family:'Dancing Script', 'Times New Roman', serif;
  font-size:1.4em;
  line-height:1.6;
  letter-spacing:0.04em;

  /* efecto tinta real */
  text-shadow:
    0 0 0.6px rgba(90,42,60,.25),
    0.3px 0.3px 0 rgba(90,42,60,.15);

  /* micro imperfecci√≥n natural */
  transform: translateZ(0);
}

#firma{
  margin-top:26px;
  font-style:italic;
  font-weight:bold;
  opacity:0;
  transform:translateY(10px);
  transition:opacity 1.6s ease, transform 1.6s ease;
}
.firma{
  font-family:'Parisienne', cursive;
  font-size:1.4em;
  opacity:0;
  transition:opacity 2s ease;
}

.firma.visible{
  opacity:1;
}


/* SEGUNDA CARTA */
.carta2{
  position:absolute;
  inset:10px;
  background:linear-gradient(
    rgba(253,247,236,0.85),
    rgba(253,247,236,0.95)
  );
  border-radius:10px;
  padding:28px 22px;
  transform:translateY(95%);
  opacity:0;
  transition:transform 1.6s ease, opacity 1.4s ease;
  box-shadow:0 12px 30px rgba(0,0,0,.4);
  overflow-y:auto;
  pointer-events:none;
}

/* ABIERTO */
.abierto .tapa{ transform:rotateX(-170deg); }
.abierto .carta{ transform:translateY(0); opacity:1; }
.abierto .sello{ opacity:0; transform:translate(-50%,-50%) scale(.6); }

/* BOT√ìN */
button{
  margin:26px auto 0;
  display:block;
  padding:16px 36px;
  border-radius:34px;
  border:none;
  background:linear-gradient(135deg,#ff758c,#ff7eb3);
  color:white;
  font-size:1.05em;
  cursor:pointer;
  box-shadow:0 12px 28px rgba(255,120,160,.65);
  transition:opacity .6s ease;
  font-family:'Playfair Display', serif;
  letter-spacing:.04em;
}
button.hide{ opacity:0; pointer-events:none; }

/* BOTONES SECUNDARIOS */
#btn2,#btn3,#btn4{
  display:none;
}

/* ESTRELLAS */
.estrella{
  position:absolute;
  top:-40px;
  width:10px;
  height:10px;
  border-radius:50%;
  background:gold;
  box-shadow:
    0 0 10px gold,
    0 0 20px rgba(255,200,120,.9),
    0 0 30px rgba(255,170,80,.8);
  animation:caer linear infinite;
  z-index:1;
}
@keyframes caer{
  to{ transform:translateY(110vh); }
}

/* GLOBOS DE CANTOYA */
.globo{
  position:absolute;
  bottom:-160px;
  width:90px;
  pointer-events:none;
  animation:flotar linear forwards;
  z-index:2;
  filter:drop-shadow(0 0 14px rgba(255,180,80,.8));
}
@keyframes flotar{
  0%{
    transform: translate3d(0, 0, 0);
    opacity: 1;
  }

  60%{
    opacity: 1;
  }

  100%{
    transform: translate3d(var(--deriva), -150vh, 0) scale(0.6);
    opacity: 0;
  }
}



/* INFINITO LUMINOSO */
.infinito{
  margin-left:6px;
  color:#ffd88a;
  text-shadow:
    0 0 6px rgba(255,220,150,.7),
    0 0 14px rgba(255,200,120,.9),
    0 0 24px rgba(255,170,80,1);
  animation:latidoInfinito 3.8s ease-in-out infinite;
}
@keyframes latidoInfinito{
  0%,100%{ opacity:.7; transform:scale(1); }
  50%{ opacity:1; transform:scale(1.15); }
}

/* ===============================
   AJUSTES ESPEC√çFICOS M√ìVIL
   iPhone + Android
   =============================== */

/* Base m√≥vil (todos) */
@media (max-width: 480px){

  body{
    padding:12px;
    align-items:flex-start;
  }

  .wrap{
    max-width:100%;
    perspective:1200px;
  }

  .sobre{
    aspect-ratio: 4 / 3;
    border-radius:12px;
  }
  .sobre{
  width:100%;
  max-width:360px;
  margin:0 auto;
}

  .carta,
  .carta2{
    padding:18px 16px;
    transform: translateY(80%);
  }

  h1{
    font-size:1.35em;
  }

  p{
    font-size:1em;
    line-height:1.6;
  }

  button{
    padding:14px 26px;
    font-size:0.95em;
  }

  #nombre-luz{
  bottom:8%;
  right:6%;
  max-width:90%;
  font-size:1.3em;
  letter-spacing:0.05em;
  }


  body{
  position:relative;
  }

  .video-fondo{
    opacity:0.7;
  }
  .carta p,
  .carta2 p{
    font-size:1.1em;
  }
  .centrador{
  transform:translateY(-6vh);
  }

}

/* ===============================
   iPhone (Safari iOS)
   =============================== */
@supports (-webkit-touch-callout: none){

  body{
    font-family:-apple-system, BlinkMacSystemFont, "San Francisco", "Helvetica Neue", sans-serif;
  }
  .video-fondo{
    opacity:0.6;
  }
  .video-activo{
    opacity:0.75;
  }
  .carta,
  .carta2{
    border-radius:14px;
  }

  h1{
    letter-spacing:0.02em;
  }

  button{
    border-radius:30px;
  }

  /* Evita saltos raros de viewport en iOS */
  .video-fondo{
    height:100vh;
    width:100vw;
  }
}

/* Android (Chrome / WebView)*/
@media (max-width: 480px) and (pointer: coarse){

  body{
    font-family: 'Segoe UI', Roboto, sans-serif;
  }

  p{
    font-size:1.02em;
  }

  button{
    box-shadow:0 10px 24px rgba(255,120,160,.55);
  }
  /* FECHA DORADA RESPIRANDO */
.fecha-dorada{
  font-family:'Times New Roman', serif;
  color:#ffd88a;
  font-size:1.45em;
  opacity:0;
  display:inline-flex;
  align-items:center;
  gap:6px;

  text-shadow:
    0 0 8px rgba(255,220,150,.5),
    0 0 18px rgba(255,200,120,.7),
    0 0 30px rgba(255,170,80,.9);

  filter:blur(6px);
  transition:
    opacity 2.2s ease,
    filter 2.6s ease;
}

/* RESPIRACI√ìN */
.fecha-dorada.respirar{
  animation:respirarFecha 5.5s ease-in-out infinite;
}

@keyframes respirarFecha{
  0%,100%{
    opacity:.75;
    transform:scale(1);
    text-shadow:
      0 0 8px rgba(255,220,150,.4),
      0 0 18px rgba(255,200,120,.6),
      0 0 30px rgba(255,170,80,.8);
  }
  50%{
    opacity:1;
    transform:scale(1.06);
    text-shadow:
      0 0 12px rgba(255,230,170,.7),
      0 0 26px rgba(255,210,140,.9),
      0 0 42px rgba(255,180,90,1);
  }
}

/* infinito */
.fecha-dorada .infinito{
  font-size:1.3em;
}
}

@media (min-width:768px){
  .wrap{
    max-width:520px;
  }
}

.centrador{
  position:fixed;
  inset:0;
  display:flex;
  justify-content:center;
  align-items:center;
  pointer-events:none;
  z-index:50;
  isolation:isolate;
  transform:translateY(-4vh);
}
.centrador .wrap{
  pointer-events:auto; 
}
@media (max-width:480px){
  .centrador{
    transform:translateY(-6vh);
  }
}
/* iOS moderno (iPhone 17 incluido)*/
@supports (-webkit-touch-callout: none){
  .centrador{
    transform:translateY(-6vh);
  }
  @supports (-webkit-touch-callout: none){
  .wrap{
    max-width:480px;
  }

  .carta p,
  .carta2 p{
    font-size:1.4em;
  }
  }

}
.titulo-escribir{
  display:inline-block;
  overflow:hidden;
  white-space:nowrap;
  border-right:2px solid rgba(255,180,200,.6);

  width:0;
  opacity:1;

  animation:
    escribirTitulo 2.8s steps(30,end) forwards,
    blinkCursor .7s step-end infinite;
}

@keyframes escribirTitulo{
  from{ width:0; }
  to{ width:100%; }
}
/* CONTENEDOR DE GLOBOS (FIX ZOOM BUG)*/
#globos-container{
  position: fixed;
  left: 0;
  bottom: 0;
  width: 100vw;
  height: 100vh;

  overflow: visible;
  pointer-events: none;
  z-index: 2;
}

#fx-layer{
  position:fixed;
  inset:0;
  overflow:hidden;
  pointer-events:none;
  z-index:1;
  isolation:isolate;
}
.carta h1,
.carta2 h1 {
  font-family: 'Parisienne', cursive;
  font-size: 2em;
  color: #5a2a3c;
  white-space: nowrap;
  border-right: 2px solid #5a2a3c; /* cursor m√°quina de escribir */
  overflow: hidden;
}

</style>
</head>

<body>
<div id="fx-layer"></div>
<div class="fondo" id="fondo"></div>
<video id="videoFondo" class="video-fondo" src="recuerdo2.mp4" autoplay loop muted playsinline></video>
<div id="nombre-luz"></div>

<div class="centrador">
  <div class="wrap">
  <div class="sobre" id="sobre">
    <div class="tapa"></div>

    <div class="sello">
      L <span class="amp">&amp;</span> S
    </div>

    <!-- CARTA 1 -->
    <div class="carta" id="carta1">
      <h1>Mi Querida Lala ‚ù§Ô∏è</h1>
      <p id="mensaje"></p>
      <p id="firma">Por siempre... tu Alonsito</p>
    </div>

    <!-- CARTA 2 -->
    <div class="carta2" id="carta2">
      <h1>üå∑Para la mejor Psicologaüå∑</h1>
      <p id="mensaje2"></p>
      <p id="firma2" style="margin-top:26px;font-style:italic;font-weight:bold; opacity:0; transform:translateY(10px); transition:opacity 1.6s ease, transform 1.6s ease;">
  Con mucho amor... tu Petuchin
    </p>

    </div>
  </div>

  <div class="luz"></div>

  <button id="btn" onclick="abrir()">T√≥came para abrir üíå</button>
  <button id="btn2" onclick="abrirSegunda()">A√∫n no se acaba... üíñ</button>
  <button id="btn3" onclick="volverPrimera()">Volver</button>
  <button id="btn4" onclick="abrirSegunda()">Ir a la segunda carta üíå</button>



  <audio id="music" src="musica.mp3"></audio>
  <audio id="music2" src="musica2.mp3"></audio>
  <audio id="papel" src="papel.mp3"></audio>
  <audio id="pluma" src="pluma.mp3"></audio>
</div>

<div id="globos-container"></div>


<script>
const texto=`S√© que es un "regalo" un poco extra√±o
pero sabes se me ocurren cosas locas...

Ha sido un a√±o largo y complicado,
pero jamas ser√° suficiente para
contener el amor que siento por ti.

A pesar de todo siempre hemos estado
el uno para el otro y nuestro cari√±o
se ha mantenido intacto.

Jam√°s olvidar√© el dia en que te conoc√≠,
Me hiciste el hombre mas feliz 
aunque no quer√≠a admitir que era as√≠.
Entraste en mi coraz√≥n y ocupaste un 
lugar demasiado especial all√≠.

Me has dado luz calida en mis dias 
grises y oscuros, s√© que me cuesta 
abrirme y no suelo expresar mucho.
Pero te aseguro que has sido siempre
mi lugar seguro.

Te mereces todo lo bonito de este
mundo, solo quiero ver esa sonrisita
que me llena de energ√≠a y de alegr√≠a,
ojal√° este peque√±o detalle sea de tu
gusto y que le de un poco de emoci√≥n
a tu d√≠a.

Espero que este sea un a√±o mas que
pase a tu lado, Que sea lleno de
prosperidad, felicidad, exitos y 
mucho amor, Siempre siempre mis 
mejores deseos para ti Alonsita. 

Feliz cumplea√±os,
Mi Princesa... ‚ù§Ô∏è`;

const texto2=`¬øPensaste que solo iba a escribir eso?
pues claramente no jeje

Nos conocimos en una partida 
cualquiera, sin imaginar que
ser√≠as la historia mas bonita 
de amor nunca antes contada.

Entre partidas y risas
encontr√© a mi calma,
mi persona favorita,
mi hogar, mi todo.

Es dificil imaginar que un
dia cualquiera, jugando un
juego cualquiera conoc√≠ a 
la persona mas bonita, la
mujer mas hermosa y la 
protagonista de todos mis sue√±os.

Agradezco a la vida por ponerte en
mi camino y a ti por dejarme ser
parte de la tuya. has sido una
pieza escencial en mi rompecabezas
y me has hecho crecer demasiado como
persona.

Eres y siempre ser√°s lo mejor que
me pudo haber regalado la vida, eres
ese tatuaje sin tinta que me acompa√±ar√°
toda mi vida y bueno... te dir√© algo 
que repito mucho.
Desde que yo exista siempre tendr√°s a 
alguien que te ccuidar√°, te admirar√°
y te va a apoyar en todo lo que tu hagas.

Eres una mujer increible y espero de
verdad te guste, es un detalle peque√±o
pero con mucho amor. Gracias por las 
risas y todos aquellos lindos momentos
que he compartido contigo.
Jamas olvides lo mucho que 
Te amo mi ni√±a üå∑ ...

S√© que a lo mejor pensaste que
dejar√≠a de ser yo, y todo iba a cambiar.
Pero no podia dejar pasar tu d√≠a 
desapercibido, asi que a pesar de no
tener mucho dinero, por lo menos quer√≠a
recordarte que hay una personita que
te ama con todo su coraz√≥n.

Pdt:No te quer√≠a mostrar nada porque 
claramente lo que estaba programando era
esto, Asi que espero que me des una 
buena calificaci√≥n, aqui est√° mi
trabajo jaja, te amoooooooo!!.`;

const frase="Te amo con toda mi alma mi Lalita ‚ù§Ô∏è";
const fecha="12/12/2024 -";
const nombreLuz=document.getElementById("nombre-luz");

const fondo=document.getElementById("fondo");
const videoFondo=document.getElementById("videoFondo");
const sobre=document.getElementById("sobre");
const mensaje=document.getElementById("mensaje");
const mensaje2=document.getElementById("mensaje2");
const btn=document.getElementById("btn");
const btn2=document.getElementById("btn2");
const btn3=document.getElementById("btn3");
const music=document.getElementById("music");
const music2=document.getElementById("music2");
const papel=document.getElementById("papel");
const pluma=document.getElementById("pluma");
const firma=document.getElementById("firma");
const carta1=document.getElementById("carta1");
const carta2=document.getElementById("carta2");

let i=0,j=0,iniciado=false,segundaAbierta=false;

/* ---------- GLOBOS ---------- */
function crearGlobo(){
  const cont = document.getElementById("globos-container");
  if (!cont || cont.children.length > 8) return;

  const g = document.createElement("img");
  g.src = "globo.png";
  g.className = "globo";

  g.style.left = Math.random() * 100 + "%";
  g.style.width = (60 + Math.random() * 40) + "px";
  g.style.setProperty("--deriva", (Math.random() * 80 - 40) + "px");
  g.style.animationDuration = (22 + Math.random() * 10) + "s";

  cont.appendChild(g);

  g.addEventListener("animationend", () => {
    g.remove();
  });
}

let globosInterval=null;

/* ---------- TEXTO CARTA 1 ---------- */
function escribir(){
  if(i<texto.length){
    mensaje.textContent+=texto.charAt(i++);
    pluma.currentTime=0;
    pluma.play().catch(()=>{});
    setTimeout(escribir,45);
  }else {
  setTimeout(() => {
    firma.style.opacity = 1;
    firma.style.transform = "translateY(0)";
    btn2.style.display = "block"; 
  }, 600);
}

}

/* ---------- TEXTO CARTA 2 ---------- */
function escribir2(){
  if(j < texto2.length){
    mensaje2.textContent += texto2.charAt(j++);
    pluma.currentTime = 0;
    pluma.play().catch(()=>{});
    setTimeout(escribir2, 45);
  } else {
    setTimeout(()=>{
      const firma2 = document.getElementById("firma2");
      firma2.style.opacity = 1;
      firma2.style.transform = "translateY(0)";
    }, 600);
  }
}


/* ---------- AUDIO ---------- */
function fadeOut(audio, duration = 2500, callback){
  if(!audio) return;

  clearInterval(audio._fadeInterval);

  const stepTime = 50;
  const steps = duration / stepTime;
  const step = audio.volume / steps;

  audio._fadeInterval = setInterval(() => {
    if(audio.volume > step){
      audio.volume -= step;
    }else{
      audio.volume = 0;
      clearInterval(audio._fadeInterval);
      audio.pause();
      if(callback) callback();
    }
  }, stepTime);
}
// M√∫sica 1 ‚Äî ultra suave
function fadeInMusica1(){
  fadeIn(music, 6500, 0.65, false);
}

function fadeOutMusica1(callback){
  fadeOut(music, 3000, callback);
}

// M√∫sica 2 ‚Äî normal
function fadeInMusica2(){
  fadeIn(music2, 2500, 1);
}

function fadeOutMusica2(callback){
  fadeOut(music2, 2500, callback);
}


function fadeIn(audio, duration = 2500, maxVolume = 1, restart = true){
  clearInterval(audio._fadeInterval);

  audio.volume = 0;

  if(restart){
    audio.currentTime = 0; // SOLO cuando quieres reiniciar
  }

  audio.play().catch(()=>{});

  const stepTime = 50;
  const steps = duration / stepTime;
  const step = maxVolume / steps;

  audio._fadeInterval = setInterval(() => {
    if(audio.volume < maxVolume - step){
      audio.volume += step;
    }else{
      audio.volume = maxVolume;
      clearInterval(audio._fadeInterval);
    }
  }, stepTime);
}

/* ---------- TEXTO LUMINOSO ---------- */
function escribirFrase(){
  nombreLuz.textContent = "";
  nombreLuz.style.opacity = 1;
  nombreLuz.style.fontSize = "1.5em";
  nombreLuz.classList.remove("palpitar");

  let k = 0;

  // ESCRIBIR "TE AMO LAURA GUZMAN"
  const escribir = setInterval(() => {
    if (k < frase.length) {
      nombreLuz.textContent += frase.charAt(k++);
    } else {
      clearInterval(escribir);

      // ‚è≥ DURACI√ìN EN PANTALLA (7 segundos)
      setTimeout(() => {

        // DESVANECER TEXTO
        nombreLuz.style.transition = "opacity 2.5s ease";
        nombreLuz.style.opacity = 0;

        // ESPERAR A QUE TERMINE DE DESVANECER
        setTimeout(() => {

          // MOSTRAR FECHA PERMANENTE
          nombreLuz.innerHTML = `${fecha}<span class="infinito">‚àû</span>`;
          nombreLuz.style.fontSize = "2em";
          nombreLuz.style.opacity = 1;
          nombreLuz.classList.add("palpitar");

        }, 2600); // tiempo del fade out

      }, 7000); // 7 segundos
    }
  }, 220); // velocidad de escritura
}


/* ---------- ABRIR PRIMERA ---------- */
function abrir(){
  if(iniciado) return;
  iniciado=true;
  btn.classList.add("hide");
  document.body.classList.add("abierto");
  sobre.classList.add("abierto");
  setTimeout(()=>papel.play().catch(()=>{}),500);
  // ESCRIBIR TITULO DE LA CARTA 1 CON EFECTO
setTimeout(() => {
  escribirTitulo(document.querySelector("#carta1 h1"), "Mi Querida Lala ‚ù§Ô∏è", 120);
}, 1300);

// ESCRIBIR EL TEXTO DE LA CARTA 1
setTimeout(escribir, 1800);

  setTimeout(fadeInMusica1, 1600);
  setTimeout(escribirFrase,1800);
    // VIDEO EN LA PRIMERA CARTA
  fondo.style.opacity = 0;
  videoFondo.classList.add("video-activo");
  videoFondo.currentTime = 0;
  videoFondo.play().catch(()=>{});

}

/* ---------- ABRIR SEGUNDA ---------- */
function abrirSegunda(){
  if(segundaAbierta) return;
  segundaAbierta = true;

  // üîπ Ocultar el bot√≥n "Ir a la segunda carta" al abrirla
  btn4.style.display = "none";

  btn2.classList.add("hide");
  btn3.style.display = "block";

  // SONIDO PAPEL SEGUNDA CARTA
  setTimeout(()=>{
    papel.currentTime = 0;
    papel.play().catch(()=>{});
  }, 400);

  // AUDIO
  fadeOutMusica1(()=>{
    fadeInMusica2();
  });

  // IMAGEN / VIDEO EN LA SEGUNDA CARTA
  videoFondo.classList.remove("video-activo");
  fondo.style.opacity = 0.45;

  // GLOBOS
  globosInterval = setInterval(crearGlobo,1400);

  // TRANSICI√ìN ENTRE CARTAS
  carta1.style.opacity = 0;
  carta1.style.transform = "translateY(-20px)";
  setTimeout(()=>{
    carta1.style.pointerEvents = "none";
    carta2.style.pointerEvents = "auto";
    carta2.style.opacity = 1;
    carta2.style.transform = "translateY(0)";

    // --- EFECTO M√ÅQUINA DE ESCRIBIR T√çTULO ---
    const tituloCarta2 = document.querySelector("#carta2 h1");
    const textoTitulo = "üå∑Para la mejor Psicologaüå∑";
    tituloCarta2.textContent = "";
    tituloCarta2.style.borderRight = "2px solid #5a2a3c"; // cursor

    let k = 0;
    const escribirTituloInterval = setInterval(() => {
      if (k < textoTitulo.length) {
        tituloCarta2.textContent += textoTitulo.charAt(k++);
      } else {
        clearInterval(escribirTituloInterval);
        tituloCarta2.style.borderRight = "none"; // quitar cursor
      }
    }, 120); // velocidad de escritura

    // TEXTO DE LA CARTA 2
    escribir2();

  },600);
}



/* ---------- VOLVER A PRIMERA ---------- */
function volverPrimera(){
  btn3.classList.add("hide");
  btn2.style.display="block";
  
  fadeOutMusica2(()=>{ fadeInMusica1(); });

  videoFondo.classList.remove("video-activo");
  fondo.style.opacity=0.45;

  clearInterval(globosInterval);

  carta2.style.opacity=0;
  carta2.style.transform="translateY(20px)";
  setTimeout(()=>{
    carta2.style.pointerEvents="none";
    carta1.style.pointerEvents="auto";
    carta1.style.opacity=1;
    carta1.style.transform="translateY(0)";

    btn4.style.display="block"; 
    segundaAbierta = false;
  },600);
}



/* ---------- ESTRELLAS ---------- */
for(let i=0;i<24;i++){
  const e=document.createElement("div");
  e.className="estrella";
  e.style.left=Math.random()*100+"vw";
  e.style.animationDuration=(6+Math.random()*5)+"s";
  document.getElementById("fx-layer").appendChild(e);
}
function escribirTitulo(elemento, texto, velocidad = 120) {
  elemento.textContent = ""; // limpiar texto previo
  elemento.style.borderRight = "2px solid #5a2a3c"; // cursor visible
  let k = 0;
  const interval = setInterval(() => {
    if (k < texto.length) {
      elemento.textContent += texto.charAt(k++);
    } else {
      clearInterval(interval);
      elemento.style.borderRight = "none"; // quitar cursor
    }
  }, velocidad);
}

</script>

</body>
</html>
